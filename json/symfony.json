{"sections":[{"title":"Démarrage d'un Projet","items":[{"title":"Créer un nouveau projet","commands":[{"label":"Pour créer un nouveau projet, on peut faire appel à l’utilitaire Symfony CLI en précisant une version 'long time suppport'.","code":"symfony new nomProjet --version=lts --webapp"},{"label":"... ou en précisant une version particulière  :","code":"symfony new nomProjet --version=\"7.0.*\" --webapp"},{"label":"On peut aussi utiliser composer :","code":"composer create-project symfony/skeleton:\"7.0.*\" nomProjet"}]},{"title":"Ajouter webapp","commands":[{"label":"Le projet symfony actuel est un squelette, un conteneur avec peu d'outils. Il est nécessaire d'ajouter webapp pour venir agrémenter le projet de fonction utilitaire au projet.","code":"composer require webapp"}]},{"title":"Ajouter Apache","commands":[{"label":"Pour ajouter Apache au projet, entrez la commande suivante.","code":"composer require symfony/apache-pack"}]},{"title":"Vérifier les vulnérabilités","commands":[{"label":"Il est possible de vérifier les vulnérabilités des dépendances, avec Symfony CLI :","code":"symfony check:security"}]},{"title":"Vérifier les pré-requis","commands":[{"label":"Il est possible de vérifier les pré-requis pour chaque dépendance, avec Symfony CLI :","code":"symfony check:requirements"}]},{"title":"Visualiser les versions PHP","commands":[{"label":"Pour visualiser les version de PHP, vous pouvez entrer la commande suivante, avec Symfony CLI :","code":"symfony local:php:list"}]},{"title":"Lancer l’application","commands":[{"label":"Vous pouvez lancer l'application depuis la console en écrivant, avec Symfony CLI :","code":"symfony open:local"}]},{"title":"Afficher les logs","commands":[{"label":"Afin d'afficher les logs, vous pouvez entrer la commande suivante.","code":"php bin/console server:log"},{"label":"ou avec Symfony CLI :","code":"symfony server:log"}]},{"title":"Lancer/arrêtez un serveur","commands":[{"label":"Vous pouvez lancer votre serveur en écrivant la commande suivante :","code":"symfony server:start -d"},{"label":"ou par le biais de php","code":"php -S localhost:8000 -t public"},{"label":"Vous pouvez l'arrêter de la manière suivante !","code":"symfony server:stop"}]},{"title":"Consulter le statur du serveur","commands":[{"label":"Consultez le status du serveur en écrivant la commande suivante :","code":"symfony server:status"}]}]},{"title":"Gestion des contrôleurs","items":[{"title":"Créer d'un Contrôleur","commands":[{"label":"Les contrôleurs sont liés aux routes définies dans l'application. Lorsqu'une requête HTTP est envoyée à une route, Symfony recherche le contrôleur associé à cette route et appelle la méthode appropriée. Ils contiennent des méthodes qui gèrent les actions associées aux routes. Ces méthodes sont appelées lorsque la route est visitée. Ils peuvent récupérer et manipuler des données à partir de diverses sources, telles que des bases de données, des fichiers, des sessions, etc. Ils peuvent générer des réponses HTTP, telles que des pages HTML, des fichiers, des erreurs, etc."},{"label":"Vous pouvez créer un contrôleur de cette manière :","code":"php bin/console make:controller NomDuControleur"},{"label":"Voici le code qui est créé dans le fichier src/Controller/TestController.php :","code":["<?php","","namespace App\\Controller;","","use Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;","use Symfony\\Component\\HttpFoundation\\Response;","use Symfony\\Component\\Routing\\Attribute\\Route;","","class TestController extends AbstractController {","    #[Route('/test', name: 'app_test')]","    public function index(): Response {","        return $this->render('test/index.html.twig', [","            'controller_name' => 'TestController',","        ]);","    }","}"]},{"label":"Un fichier Twig correspondant est également créé dans templates/test/index.html.twig :","code":["{% extends 'base.html.twig' %}","","{% block title %}Hello TestController!{% endblock %}","","{% block body %}","    {# {...} #}","{% endblock %}"]}]},{"title":"Annoter les routes","commands":[{"label":"Définissez une route pour une méthode de contrôleur avec l'annotation `#[Route]` :","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","class PostController extends AbstractController {","    #[Route('/posts', name: 'post_index')]","    public function index(): Response {","        // ...","    }","}"]}]},{"title":"Créer une méthode `index`","commands":[{"label":"Exemple de méthode `index` pour afficher une liste de produits :","code":["use Symfony\\Component\\HttpFoundation\\Response;","","class PostController extends AbstractController {","    #[Route('/posts', name: 'post_index')]","    public function index(): Response {","        // Récupération de tous les produits","        $posts = $this->getDoctrine()","            ->getRepository(Post::class)","            ->findAll();","","        // Rendu de la vue","        return $this->render('post/index.html.twig', [","            'posts' => $posts,","        ]);","    }","}"]}]},{"title":"Créer une méthode `show`","commands":[{"label":"Exemple de méthode `show` pour afficher les détails d'un produit spécifique :","code":["use Symfony\\Component\\HttpFoundation\\Response;","","class PostController extends AbstractController {","    #[Route('/posts/{id}', name: 'post_show')]","    public function show(int $id): Response {","        // Récupération du produit par ID","        $post = $this->getDoctrine()","            ->getRepository(Post::class)","            ->find($id);","","        if (!$post) {","            throw $this->createNotFoundException('Produit non trouvé');","        }","","        // Rendu de la vue","        return $this->render('post/show.html.twig', [","            'post' => $post,","        ]);","    }","}"]}]},{"title":"Créer une méthode `create`","commands":[{"label":"Exemple de méthode `create` pour ajouter un nouveau produit :","code":["use Symfony\\Component\\HttpFoundation\\Request;","use Symfony\\Component\\HttpFoundation\\Response;","use Symfony\\Component\\Routing\\Annotation\\Route;","","class PostController extends AbstractController {","    #[Route('/posts/new', name: 'post_create')]","    public function create(Request $request): Response {","        $post = new Post();","","        // Formulaire","        $form = $this->createForm(PostType::class, $post);","        $form->handleRequest($request);","","        if ($form->isSubmitted() && $form->isValid()) {","            $entityManager = $this->getDoctrine()->getManager();","            $entityManager->persist($post);","            $entityManager->flush();","","            return $this->redirectToRoute('post_index');","        }","","        // Rendu de la vue","        return $this->render('post/create.html.twig', [","            'form' => $form->createView(),","        ]);","    }","}"]}]},{"title":"Créer une méthode `delete`","commands":[{"label":"Exemple de méthode `delete` pour supprimer un produit :","code":["use Symfony\\Component\\HttpFoundation\\Request;","use Symfony\\Component\\HttpFoundation\\Response;","use Symfony\\Component\\Routing\\Annotation\\Route;","","class PostController extends AbstractController {","    #[Route('/posts/delete/{id}', name: 'post_delete')]","    public function delete(int $id, Request $request): Response {","        $entityManager = $this->getDoctrine()->getManager();","        $post = $entityManager->getRepository(Post::class)->find($id);","","        if (!$post) {","            throw $this->createNotFoundException('Produit non trouvé');","        }","","        $entityManager->remove($post);","        $entityManager->flush();","","        return $this->redirectToRoute('post_index');","    }","}"]}]}]},{"title":"Utilisation des entités","items":[{"title":"Créer une Entité","commands":[{"label":"Utilisez la commande suivante pour générer une entité :","code":"php bin/console make:entity"},{"label":["Étapes de création :","- Nommer l'entité. Par exemple : [italics]post[/italics].","- Ajouter des propriétés. Par exemple : [italics]title[/italics], [italics]content[/italics], etc.","- Symfony générera automatiquement le fichier PHP correspondant dans le dossier [italics]src/Entity[/italics]."]}]},{"title":"Définir les types de variables","commands":[{"label":"Vous pouvez définir divers types de propriétés dans votre entité en utilisant les attributs Doctrine ORM pour Symfony 7 :"},{"label":"Une chaîne de caractères","code":["#[ORM\\Column(length: 255)]","private ?string $title = null;"]},{"label":"Un texte","code":["#[ORM\\Column(type: Types::TEXT)]","private ?string $content = null;"]},{"label":"Un entier","code":["#[ORM\\Column]","private ?int $id = null;"]},{"label":"Un nombre à virgule flottante","code":["#[ORM\\Column(type: Types::FLOAT)]","private ?float $price = null;"]},{"label":"Un booléen","code":["#[ORM\\Column(type: Types::BOOLEAN)]","private ?bool $published = null;"]},{"label":"Une date et heure","code":["#[ORM\\Column]","private ?\\DateTimeImmutable $createdAt = null;"]},{"label":"Un texte long","code":["#[ORM\\Column(type: Types::TEXT)]","private ?string $content = null;"]},{"label":"Voici un exemple complet d'une entité :","code":["<?php","","namespace App\\Entity;","","use App\\Repository\\PostRepository;","use Doctrine\\DBAL\\Types\\Types;","use Doctrine\\ORM\\Mapping as ORM;","","#[ORM\\Entity(repositoryClass: PostRepository::class)]","class Post","{","    #[ORM\\Id]","    #[ORM\\GeneratedValue]","    #[ORM\\Column]","    private ?int $id = null;","","    #[ORM\\Column(length: 255)]","    private ?string $title = null;","","    #[ORM\\Column(length: 255)]","    private ?string $slug = null;","","    #[ORM\\Column(type: Types::TEXT)]","    private ?string $content = null;","","    #[ORM\\Column]","    private ?\\DateTimeImmutable $createdAt = null;","","    #[ORM\\Column]","    private ?\\DateTimeImmutable $updatedAt = null;","","    // {...}","}"]},{"label":"Des getters et des setters seront aussi générés automatiquement, comme ceux-ci :","code":["class Post","{","    // {...}","","    public function getId(): ?int {","        return $this->id;","    }","","    public function getTitle(): ?string {","        return $this->title;","    }","}"]}]},{"title":"Générer une clef primaire (id)","commands":[{"label":"Définir une clé primaire (ID) pour votre entité :","code":["@ORM\\Id","@ORM\\GeneratedValue(strategy=\"AUTO\")","@ORM\\Column(type=\"integer\")","private $id;"]}]},{"title":"Créer une relation","commands":[{"label":"Définir des relations entre les entités :","code":["// Une entité possède une autre entité","@ORM\\OneToOne(targetEntity=\"User\")","","// Plusieurs produits peuvent avoir plusieurs tags","@ORM\\ManyToMany(targetEntity=\"Tag\")"]},{"label":"1) Plusieurs produits peuvent appartenir à une catégorie","code":"@ORM\\ManyToOne(targetEntity=\"Category\")"},{"label":"2) Une catégorie a plusieurs produits","code":"@ORM\\OneToMany(targetEntity=\"Post\", mappedBy=\"category\")"}]}]},{"title":"Utilisation de repository","items":[{"title":"Créer un repository","commands":[{"label":"Les [strong]repositories[/strong] sont générés dans le dossier [italics]src/Repository[/italics] en même temps que les entités dont elles dépendent. Une entité est associé à un repository. Vous pouvez les générer avec cette commande.","code":"php bin/console make:entity"},{"label":"Ajoutez le namespace pour le repository.","code":"namespace App\\Repository;"},{"label":"Exemple simple de repository pour l'entité [italics]Post[/italics]s :","code":["use App\\Entity\\Post;","use Doctrine\\Bundle\\DoctrineBundle\\Repository\\ServiceEntityRepository;","use Doctrine\\Persistence\\ManagerRegistry;","","class PostRepository extends ServiceEntityRepository","{","    public function __construct(ManagerRegistry $registry) {","        parent::__construct($registry, Post::class);","    }","","    public function findByPriceGreaterThan(float $price) {","        return $this->createQueryBuilder('p')","            ->andWhere('p.price > :price')","            ->setParameter('price', $price)","            ->orderBy('p.price', 'ASC')","            ->getQuery()","            ->getResult();","    }","}"]}]},{"title":"Utiliser un repository","commands":[{"label":"Pour appeler un repository dans une entité, utilisez le constructeur pour injecter le repository dans la classe :","code":["namespace App\\Entity;","","use Doctrine\\ORM\\Mapping as ORM;","use App\\Repository\\PostRepository;","","class SomeService {","    private $postRepository;","","    public function __construct(PostRepository $postRepository) {","        $this->postRepository = $postRepository;","    }","","    public function someMethod() {","        $post = $this->postRepository->find($id);","        // Effectuer des opérations sur $post","    }","}"]}]},{"title":"Utiliser les méthodes du repository","commands":[{"label":"Les repositories possèdent différentes méthodes auxquelles on peut faire appel."},{"label":"1) Trouver tous les enregistrements :","code":"$repository->findAll();"},{"label":"2) Trouver un enregistrement par ID :","code":"$repository->find($id);"},{"label":"3) Trouver des enregistrements par critère :","code":"$repository->findBy(['field' => 'value']);"},{"label":"4) Trouver un enregistrement par critère :","code":"$repository->findOneBy(['field' => 'value']);"},{"label":"5) Trouver des enregistrements en utilisant des critères, l'ordre, la limite et l'offset :","code":"$repository->findBy(['field' => 'value'], ['field' => 'ASC'], 10, 20);"},{"label":"6) Compter le nombre d'enregistrements par critère :","code":"$repository->count(['field' => 'value']);"},{"label":"7) Trouver les valeurs distinctes pour un champ :","code":"$repository->findDistinctByField('field');"},{"label":"8) Trouver en utilisant une requête personnalisée","code":["// Requêtes DQL pour des besoins spécifiques","$dql = \"SELECT p FROM App\\Entity\\Post p WHERE p.price > 100\";","$query = $this->getEntityManager()->createQuery($dql);","$results = $query->getResult();"]}]},{"title":"Personnaliser une requêtes","commands":[{"label":"Voici un exemple. Cette requête trouve tous les produits appartenant à une catégorie spécifique, triés par prix croissant.","code":["public function findPostsByCategory($categoryId) {","    return $this->createQueryBuilder('p')","        ->where('p.category = :category')","        ->setParameter('category', $categoryId)","        ->orderBy('p.price', 'ASC')","        ->getQuery()","        ->getResult();","}"]},{"label":"Utiliser `where` pour ajouter une condition :","code":"$qb->where('p.category = :category');"},{"label":"Utiliser `andWhere` pour ajouter une condition supplémentaire avec AND :","code":"$qb->andWhere('p.price <= :maxPrice');"},{"label":"Utiliser `orWhere` pour ajouter une condition avec OR :","code":"$qb->orWhere('p.price >= :minPrice');"},{"label":"Utiliser `orderBy` pour trier les résultats :","code":"$qb->orderBy('p.price', 'ASC');"},{"label":"Utiliser `groupBy` pour grouper les résultats :","code":"$qb->groupBy('p.category');"},{"label":"Utiliser `having` pour ajouter une condition sur les résultats groupés :","code":"$qb->having('COUNT(p.id) > 5');"},{"label":"Utiliser `join` pour ajouter une jointure :","code":"$qb->join('p.category', 'c');"},{"label":"Utiliser `leftJoin` pour ajouter une jointure à gauche :","code":"$qb->leftJoin('p.category', 'c');"},{"label":"Utiliser `innerJoin` pour ajouter une jointure interne :","code":"$qb->innerJoin('p.category', 'c');"},{"label":"Utiliser `setFirstResult` pour définir l'offset :","code":"$qb->setFirstResult(10);"},{"label":"Utiliser `setMaxResults` pour définir la limite :","code":"$qb->setMaxResults(20);"},{"label":"Utiliser `setParameter` pour lier un paramètre :","code":"$qb->setParameter('category', $categoryId);"}]},{"title":"Utiliser le DQL","commands":[{"label":"Le DQL (Doctrine Query Language) est utilisé pour écrire des requêtes plus complexes :","code":["$dql = \"SELECT s FROM App\\Entity\\Serie AS s","WHERE s.popularity > 200","ORDER BY s.vote DESC\";","$query = $em->createQuery($dql);"]}]},{"title":"Spécifier une hydratation.","commands":[{"label":"Les méthodes de repository retournent généralement des objets entité. Vous pouvez spécifier le type d'hydratation si nécessaire :","code":["$query->getResult(); // Par défaut, retourne des objets entité","$query->getArrayResult(); // Retourne les résultats sous forme de tableaux associatifs","$query->getScalarResult(); // Retourne les résultats sous forme de tableaux scalaires"]}]},{"title":"Paginer avec Paginator","commands":[{"label":"Utilisez le `Paginator` pour paginer les résultats d'une requête :","code":["use Doctrine\\ORM\\Tools\\Pagination\\Paginator;","","public function findPaginatedPosts(int $page, int $limit) {","    $qb = $this->createQueryBuilder('p')","        ->setFirstResult(($page - 1) * $limit)","        ->setMaxResults($limit);","","    $query = $qb->getQuery();","    $paginator = new Paginator($query);","    return $paginator;","}"]}]},{"title":"Utiliser EntityManagerInterface","commands":[{"label":"L'Entity Manager est utilisé pour gérer les entités et effectuer des opérations sur la base de données :","code":["use Doctrine\\ORM\\EntityManagerInterface;","","// Injection de l'Entity Manager dans un service ou un contrôleur","class PostService {","    private $entityManager;","","    public function __construct(EntityManagerInterface $entityManager) {","        $this->entityManager = $entityManager;","    }","","    public function savePost(Post $post): void {","        // Persiste l'entité dans la base de données","        $this->entityManager->persist($post);","        $this->entityManager->flush();","    }","","    public function deletePost(Post $post): void {","        // Supprime l'entité de la base de données","        $this->entityManager->remove($post);","        $this->entityManager->flush();","    }","}"]}]},{"title":"Utiliser les transactions (A CONFIRMER !)","commands":[{"label":"Utilisez les transactions pour garantir l'intégrité des données lors de multiples opérations :","code":["$this->entityManager->beginTransaction();","try {","    // Opérations de persistance","    $this->entityManager->persist($entity1);","    $this->entityManager->persist($entity2);","    $this->entityManager->flush();","","    // Validation de la transaction","    $this->entityManager->commit();","} catch (Exception $e) {","    // Annulation de la transaction en cas d'erreur","    $this->entityManager->rollback();","    throw $e;","}"]}]}]},{"title":"Validation des données","items":[{"title":"Introduction","commands":[{"label":"La [strong]validation des données[/strong] est une étape [strong]obligatoire[/strong] dans le développement d'applications. Dans Symfony, il est possible d'ajouter des contraintes de validation directement au niveau des formulaires. Cependant, il est généralement recommandé de les appliquer au niveau des entités associées aux formulaires. Cette approche permet de centraliser la logique de validation et de garantir que les règles s'appliquent de manière cohérente, que les données proviennent d'un formulaire ou d'une autre source."}]},{"title":"NotBlank","commands":[{"label":"La contrainte [strong]NotBlank[/strong] assure que le champ n'est pas vide. Voici comment l'utiliser dans une entité :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[Assert\\NotBlank(message=\"Ce champ ne peut pas être vide.\")]","private $name;"]}]},{"title":"Length","commands":[{"label":"La contrainte [strong]Length[/strong] contrôle la longueur minimale et/ou maximale d'une chaîne. Voici comment l'utiliser dans une entité :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[Assert\\Length(","    min=3,","    max=255,","    minMessage=\"La longueur minimale est de 3 caractères.\",","    maxMessage=\"La longueur maximale est de 255 caractères.\"",")]","private $description;"]}]},{"title":"Positive","commands":[{"label":"La contrainte [strong]Positive[/strong] assure que la valeur est positive (supérieure à zéro). Voici un exemple :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[Assert\\Positive(message=\"La valeur doit être positive.\")]","private $price;"]}]},{"title":"Range","commands":[{"label":"La contrainte [strong]Range[/strong] vérifie que la valeur se situe dans une plage donnée. Voici comment l'utiliser :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[Assert\\Range(","    min=1,","    max=100,","    notInRangeMessage=\"La valeur doit être comprise entre 1 et 100.\"",")]","private $quantity;"]}]},{"title":"Email","commands":[{"label":"La contrainte [strong]Email[/strong] valide que le champ contient une adresse email valide. Voici un cas concret :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[Assert\\Email(message=\"L'email '{{ value }}' n'est pas valide.\")]","private $email;"]}]},{"title":"Date","commands":[{"label":"La contrainte [strong]Date[/strong] assure que le champ contient une date valide. Voici comment l'utiliser :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[Assert\\Date(message=\"La date '{{ value }}' n'est pas valide.\")]","private $birthDate;"]}]},{"title":"UniqueEntity","commands":[{"label":"La contrainte [strong]UniqueEntity[/strong] vérifie que la valeur est unique dans la base de données. Voici un exemple :","code":["use Doctrine\\ORM\\Mapping as ORM;","use Symfony\\Bridge\\Doctrine\\Validator\\Constraints\\UniqueEntity;","use Symfony\\Component\\Validator\\Constraints as Assert;","","#[ORM\\Entity(repositoryClass: PostRepository::class)]","#[UniqueEntity('title')]","#[UniqueEntity('slug')]","class Post { }"]},{"label":"Vous pouvez passer un tableau directement. Dans ce cas-là, c'est la combinaison des champs qui doit être unique."}]},{"title":"Choice","commands":[{"label":"La contrainte [strong]Choice[/strong] assure que la valeur fait partie d'un ensemble de choix prédéfinis. Voici comment l'utiliser dans une entité :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[Assert\\Choice(","    choices={\"low\", \"medium\", \"high\"},","    message=\"Choisissez une priorité valide parmi 'low', 'medium', ou 'high'.\",","    multiple=true,","    min=1,","    max=3,",")]","private $priority;"]}]},{"title":"Regex","commands":[{"label":"La contrainte [strong]Regex[/strong] valide que la valeur correspond à un motif regex spécifique. Voici un exemple :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[Assert\\Regex(","    pattern=\"/^[a-zA-Z0-9]+$/\",","    message=\"Le champ doit contenir uniquement des lettres et des chiffres.\",","    match=true,",")]","private $username;"]}]},{"title":"Image","commands":[{"label":"La contrainte [strong]Image[/strong] assure que l'utilisateur télécharge une image ayant une taille et un type particulier. Voici un exemple particulier.","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","","#[Assert\\Image(","    maxSize: '2M',","    maxSizeMessage: 'L\\'image ne peut pas dépasser {{ limit }} {{ suffix }}.',","    mimeTypes: ['image/jpeg', 'image/png', 'image/gif'],","    mimeTypesMessage: 'Veuillez télécharger une image au format JPEG, PNG ou GIF.'",")]","private $photo;"]}]},{"title":"Url","commands":[{"label":"La contrainte [strong]Url[/strong] permet de valider la saisie d'un champ url correctement. Voici un exemple d'utilisation :","code":["#[Assert\\Url(","    message=\"L'URL '{{ value }}' n'est pas valide.\"",")]","private $website;"]}]},{"title":"EqualTo","commands":[{"label":"Cette contrainte [strong]EqualTo[/strong] permet de vérifier l'équivalence avec un autre champ, c'est le cas pour les mots de passe, par exemple, donné ci-dessous.","code":["#[Assert\\EqualTo(","    propertyPath: \"password\",","    message=\"Les mots de passe doivent correspondre.\"",")]","private $confirmPassword;"]}]},{"title":"Count","commands":[{"label":"La contrainte [strong]Count[/strong] vérifie que le nombre d'éléments dans un tableau est bien compris dans une place données, par exemple pour un tableau de tags.","code":["#[Assert\\Count(","    min: 1,","    max: 5,","    minMessage: \"Vous devez sélectionner au moins {{ limit }} élément.\",","    maxMessage: \"Vous ne pouvez pas sélectionner plus de {{ limit }} éléments.\"",")]","private $tags; // Supposons que c'est un tableau de tags"]}]},{"title":"Ajouter un Group","commands":[{"label":"Il est également possible d'ajouter un groupe à une contrainte pour contrôler quand elle doit être appliquée. Voici comment procéder avec la contrainte NotBlank :","code":["#[Assert\\NotBlank(","    message=\"Ce champ ne peut pas être vide.\",","    groups={\"Default\", \"CustomGroup\"}",")]","private $name;"]}]},{"title":"Créer une validation personnalisée","commands":[{"label":"Vous pouvez créer vos propres validateur, qui sont enreprosés dans le dossier [italics]src/Validator[/italics]. Il vous faut entrer dans la console avec [italics]nomValidator[/italics] (composé de [italics]nom[/italics] et de [italics]Validator[/italics])","code":"php bin/console make:validator nomValidator"},{"label":"Cela créer deux fichiers. Le premier est nom.php :","code":["use Symfony\\Component\\Validator\\Constraint;","","#[\\Attribute(\\Attribute::TARGET_PROPERTY | \\Attribute::TARGET_METHOD | \\Attribute::IS_REPEATABLE)]","class BanWord extends Constraint {","    public string $message = 'The value \"{{ value }}\" is not valid.';","}"]},{"label":"Et le deuxième nomValidator.php :","code":["use Symfony\\Component\\Validator\\Constraint;","use Symfony\\Component\\Validator\\ConstraintValidator;","","class BanWordValidator extends ConstraintValidator {","    public function validate(mixed $value, Constraint $constraint): void {","        /* @var nom $constraint */","        if (null === $value || '' === $value) { return;}","        $this->context->buildViolation($constraint->message)","            ->setParameter('{{ value }}', $value)","            ->addViolation();","    }","}"]},{"label":"Et vous pouvez ainsi utiliser votre validateur dans l'entité :","code":["use Symfony\\Component\\Validator\\Constraints as Assert;","// {...}","","#[BanWord()]","private $content;"]}]}]},{"title":"Création de routes","items":[{"title":"Nommer une route","commands":[{"label":"Afin de créer une route en Symfony, vous pouvez écrire la route suivante. A gauche on utilise l'url relative pour accéder à la ressource. A droite, il y a le nom de la route. C'est ce nom là que l'on utilise avec la fonction path du côté Twig. On renvoie le nom de la vue dans la fonction render().","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/posts/detail/{id}', name: 'post_detail')]","public function detail(int $id): Response {","  return $this->render('main/home.html.twig');","}"]}]},{"title":"Utiliser un joker","commands":[{"label":"Les jokers sont des symboles comme {id} utilisés dans les routes ou les traductions pour marquer des emplacements où des valeurs variables seront insérées plus tard.","code":["#[Route('/utilisateurs/profils/{id}', requirements: ['id'=>'\\d+'])]","public function userProfile(int $id): Response {","    // Votre logique ici","}"]}]},{"title":"Débogguer une route","commands":[{"label":"Pour débogguer une route, vous pouvez entrer la commande suivant dans la console :","code":"php bin/console debug:router"},{"label":"...ou avec Symfony CLI :","code":"symfony console debug:router"}]},{"title":"Détailler une route","commands":[{"label":"Pour afficher les détails d'une route spécifique, veuillez entrer la console suivante :","code":"php bin/console debug:router nomDeLaRoute"},{"label":"...ou avec Symfony CLI :","code":"symfony console debug:router nomDeLaRoute"}]},{"title":"Tester une route","commands":[{"label":"Pour tester le match entre une URL et une route","code":"php bin/console router:match /url-a-tester"},{"label":"...ou avec Symfony CLI :","code":"symfony console router:match /url-a-tester"}]},{"title":"Générer une URL pour une route","commands":[{"label":"Vous pouvez utiliser [strong]path[/strong] dans Twig pour générer une URL relative à partir du nom de la route.","code":["{# Générer une URL relative #}","<a href=\"{{ path('post_detail', {'id': 123}) }}\">Voir le produit</a>"]},{"label":"... ou utiliser [strong]url[/strong] pour générer une route absolue.","code":["{# Générer une URL absolue #}","<a href=\"{{ url('post_detail', {'id': 123}) }}\">Voir le produit</a>"]}]},{"title":"Ajouter des paramètres optionnels","commands":[{"label":"Vous pouvez construire des routes, vous pouvez utiliser des paramètres optionnels. Pour ce faire, il faut inscrire des valeurs par défaut.","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/posts/{category}/{page}', name: 'post_list', defaults: ['category' => 'all', 'page' => 1])]","public function list(string $category = 'all', int $page = 1): Response {","    // Votre logique ici","}"]}]},{"title":"Préfixer de route","commands":[{"label":"Pour organiser les routes sous un chemin commun, il est nécessaire d'ajouter un préfexe au-dessus de la classe. En premier paramètre se trouve le \"préfixe\" de l'url, et en second paramètre se situe le préfixe pour le nom du chemin.","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/admin', name: 'admin_')]","class AdminController {","","    #[Route('/dashboard', name: 'dashboard')]","    public function dashboard(): Response {","        // Route complète: /admin/dashboard","    }","","    #[Route('/users', name: 'users')]","    public function users(): Response {","        // Route complète: /admin/users","    }","}"]}]},{"title":"Rediriger une route","commands":[{"label":"Il est tout aussi possible de rediriger une URL vers une autre route ou URL.","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/old-path', name: 'old_path')]","public function oldPath(): Response {","    return $this->redirectToRoute('new_path');","}","","#[Route('/new-path', name: 'new_path')]","public function newPath(): Response {","    // Nouvelle logique ici","}"]}]},{"title":"Utiliser les méthodes HTTP","commands":[{"label":"Vous pouvez limiter les routes à certaines méthodes HTTP (GET, POST, etc.).","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/submit', name: 'form_submit', methods: ['POST'])]","public function submit(): Response {","    // Logique de soumission de formulaire","}"]}]},{"title":"Générer des routes dans PHP","commands":[{"label":"Vous pouvez utiliser le générateur de routes Symfony dans les contrôleurs PHP.","code":["use Symfony\\Component\\Routing\\Generator\\UrlGeneratorInterface;","","public function generateUrlExample(UrlGeneratorInterface $urlGenerator): Response {","    $url = $urlGenerator->generate('post_detail', ['id' => 123]);","    // Utiliser $url comme URL générée","}"]}]},{"title":"Grouper des routes","commands":[{"label":"Organiser des routes similaires en groupes avec des préfixes ou des options partagées.","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/blog')]","class BlogController {","","    #[Route('/list', name: 'blog_list')]","    public function list(): Response {","        // Route complète: /blog/list","    }","","    #[Route('/post/{id}', name: 'blog_post')]","    public function post(int $id): Response {","        // Route complète: /blog/post/{id}","    }","}"]}]},{"title":"Conditionner des routes","commands":[{"label":"Si vous souhaitez contraindre vos routes à certains conditions, vous pouvez utiliser la structure suivante.","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/special/{id}', name: 'special', condition: 'params[\"id\"] > 10')]","public function special(int $id): Response {","    // Cette route est matchée seulement si l'id est supérieur à 10.","}"]}]},{"title":"Définir des routes avec des hôtes et des schémas spécifiques","commands":[{"label":"Vous pouvez définir des routes avec des schémas HTTPS...","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/secure', name: 'secure_page', schemes: ['https'])]","public function secure(): Response {","    // Cette route est accessible seulement via HTTPS.","}",""]},{"label":"...ou définir des routes avec des hôtes spécifiques","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/subdomain', name: 'subdomain_page', host: 'sub.example.com')]","public function subdomain(): Response {","    // Cette route est accessible seulement via le sous-domaine spécifié.","}"]}]},{"title":"Préfixer pour des langues","commands":[{"label":"Configurer des routes avec des préfixes de langues pour les applications multilingues.","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/{_locale}/about', name: 'about', requirements: ['_locale' => 'en|fr|es'])]","public function about(): Response {","    // Route disponible en plusieurs langues.","}"]}]},{"title":"Paramètrer des routes avec des regex","commands":[{"label":"Utiliser des expressions régulières pour contraindre les paramètres de route.","code":["use Symfony\\Component\\Routing\\Annotation\\Route;","","#[Route('/posts/{name}', name: 'post_detail', requirements: ['name' => '[a-zA-Z]+'])]","public function detail(string $name): Response {","    // Cette route match seulement si le nom est composé de lettres majuscules ou minuscules.","}"]}]}]},{"title":"Utilisation des formulaires","items":[{"title":"Créer un Formulaire","commands":[{"label":"Pour créer un formulaire, utilisez la commande suivante :","code":"php bin/console make:form NomDuFormulaire"},{"label":"ou avec Symfony CLI :","code":"symfony console make:form NomDuFormulaire"},{"label":"Cette commande génère un fichier de type formulaire dans `src/Form/NomDuFormulaireType.php`."}]},{"title":"Définir les champs d'un formulaire","commands":[{"label":"Ajoutez les champs du formulaire dans la méthode [strong]buildForm[/strong] :","code":["namespace App\\Form;","","use App\\Entity\\Post;","use Symfony\\Component\\Form\\AbstractType;","use Symfony\\Component\\Form\\FormBuilderInterface;","use Symfony\\Component\\OptionsResolver\\OptionsResolver;","use Symfony\\Component\\Form\\Extension\\Core\\Type\\TextType;","use Symfony\\Component\\Form\\Extension\\Core\\Type\\MoneyType;","use Symfony\\Component\\Form\\Extension\\Core\\Type\\SubmitType;","","class PostType extends AbstractType {","    public function buildForm(","        FormBuilderInterface $builder,","        array $options): void {","        $builder","            ->add('title')","            ->add('slug')","            ->add('content')","            ->add('createdAt', null, [","                'widget' => 'single_text',","            ])","            ->add('updatedAt', null, [","                'widget' => 'single_text',","            ])","        ;","    }","","    public function configureOptions(","        OptionsResolver $resolver): void {","        $resolver->setDefaults([","            'data_class' => Recipe::class,","        ]);","    }","}"]}]},{"title":"Ajouter un champ envoyer","commands":[{"label":"Vous pouvez ajouter un champ \"Envoyer\" de la manière suivante :","code":["use Symfony\\Component\\Form\\Extension\\Core\\Type\\SubmitType;","// {...}","","->add('save', SubmitType::class, [","    'label' => 'Envoyer'","]);"]}]},{"title":"Utiliser un formulaire dans un contrôleur","commands":[{"label":"Gérez le formulaire dans un contrôleur pour traiter les soumissions :","code":["namespace App\\Controller;","","use App\\Entity\\Post;","use App\\Form\\PostType;","use Symfony\\Component\\HttpFoundation\\Request;","use Symfony\\Component\\HttpFoundation\\Response;","use Symfony\\Bundle\\FrameworkBundle\\Controller\\AbstractController;","use Symfony\\Component\\Routing\\Annotation\\Route;","","class PostController extends AbstractController {","    #[Route('/post/new', name: 'post_new')]","    public function new(Request $request): Response {","        $post = new Post();","        $form = $this->createForm(PostType::class, $post);","        $form->handleRequest($request);","","        if ($form->isSubmitted() && $form->isValid()) {","            $entityManager = $this->getDoctrine()->getManager();","            $entityManager->persist($post);","            $entityManager->flush();","","            return $this->redirectToRoute('post_index');","        }","","        return $this->render('post/post_new.html.twig', [","            'myform' => $form->createView(),","        ]);","    }","}"]}]},{"title":"Construire un formulaire avec Twig","commands":[{"label":"Utilisez les fonctions Twig pour afficher le formulaire :","code":["{# post/new.html.twig #}","<h1>Ajouter un nouveau produit</h1>","{{ form_start(myform) }}","    {{ form_row(myform.name) }}","    {{ form_row(myform.price) }}","    {{ form_row(myform.save) }}","{{ form_end(myform) }}"]}]},{"title":"Ajouter un thème pour un formulaire","commands":[{"label":"Il est possible d'ajouter un thème personnalisé pour un form, par exemple [italics]bootstrat_5_twig[/italics]. Il faut vous rendre dans [italics]/config/packages/twig.yaml[/italics] et changer le code ainsi.","code":["twig:","    file_name_pattern: '*.twig'","    form_themes:  ['bootstrap_5_layout.html.twig']"]}]},{"title":"Récupérer les données soumises","commands":[{"label":"La méthode [strong]handleRequest[/strong] de [strong]Request[/strong] modifie les données d'une entité en les remplaçant par les données soumises dans le formulaire. Ainsi, on les lie aux champs du formulaire et on déclenche la validation.","code":["// {...}","public function edit(Post $post, Request $request): Response {","        $form = $this->createForm(PostType::class, $post);","        $form->handleRequest($request);","        // {...}","    }"]}]},{"title":"Vérifier la soumission du formulaire","commands":[{"label":"La méthode [strong]handleRequest[/strong] de [strong]Request[/strong] modifie les données d'une entité en les remplaçant par les données soumises dans le formulaire. Ainsi, on les lie aux champs du formulaire et on déclenche la validation.","code":["// {...}","use Doctrine\\ORM\\EntityManagerInterface;","// {...}","public function edit(","        Recipe $recipe,","        Request $request,","        EntityManagerInterface $em): Response {","        // {...}","        if ($form->isSubmitted() && $form->isValid()) {","            $em->flush();","            return $this->redirectToRoute('post_display', ['id' => $post->getId()]);","        }","        // {...}","    }"]}]},{"title":"Personnaliser le comportement des formulaires","commands":[{"label":["Dans symfony, les événements de formulaire sont essentiels pour personnaliser leur comportement à différentes étapes de leur cycle de vie. On peut utiliser trois événements clés [strong]PRE_SUBMIT[/strong], [strong]SUBMIT[/strong] et [strong]POST_SUBMIT[/strong]. Chacun de ces éléments sont à ajouter dans la classe [italics]XxxxxType[/italics] (ex.: PostType) du fichier portant le même nom dans la méthode [italics]builfForm[/italics].","- L'événement [strong]PRE_SUBMIT[/strong] est déclenché avant que les données du formulaire ne soient transformées en modèle. Cet événement permet donc de manipuler les données soumises avant leur traitement."],"code":["use Symfony\\Component\\Form\\FormEvents;","use Symfony\\Component\\Form\\FormEvent;","","$builder->addEventListener(FormEvents::PRE_SUBMIT, function (FormEvent $event) {","    $data = $event->getData();","    // Modifiez $data ici avant qu'il ne soit traité","    $event->setData($data);","});"]},{"label":"- L'événement [strong]SUBMIT[/strong] se produit juste après que les données du formulaire ont été transformées en modèle, mais avant toute validation. C'est une occasion d'implémenter toute logique supplémentaire qui dépend des données soumises, mais qui n'affecte pas la structure des données elle-même.","code":["$builder->addEventListener(FormEvents::SUBMIT, function (FormEvent $event) {","    // Logique qui doit se produire après la soumission mais avant la validation","});"]},{"label":"- L'événement [strong]POST_SUBMIT[/strong] est déclenché après que le formulaire a été soumis et validé. Cet événement est utile pour effectuer des actions basées sur l'état final des données du formulaire, comme mettre à jour des entités connexes ou déclencher d'autres processus en fonction des informations soumises.","code":["$builder->addEventListener(","    FormEvents::POST_SUBMIT,","    function (FormEvent $event) {","    // Accédez aux données soumises et validées","    $formData = $event->getData();","    // Effectuez des actions basées sur $formData","});"]},{"label":"Voici un exemple complet lors de l'inscription d'un utilisateur à une newsletter.","code":["use Symfony\\Component\\Form\\FormEvents;","use Symfony\\Component\\Form\\FormEvent;","use Symfony\\Component\\Form\\FormError;","","$builder->addEventListener(","    FormEvents::PRE_SUBMIT,","    function (FormEvent $event) {","    $data = $event->getData();","","    // Convertir l'adresse e-mail en minuscules","    if (isset($data['email'])) {","        $data['email'] = strtolower($data['email']);","    }","","    $event->setData($data);","});","","$builder->addEventListener(","    FormEvents::SUBMIT,","    function (FormEvent $event) {","    $data = $event->getData();","","    // Vérifier si l'adresse e-mail est valide","    if (!filter_var($data['email'], FILTER_VALIDATE_EMAIL)) {","        // Ajouter une erreur au formulaire","        // si l'e-mail n'est pas valide","        $form = $event->getForm();","        $form->addError(","            new FormError('L\\'adresse e-mail est invalide.'));","    }","});","","$builder->addEventListener(","    FormEvents::POST_SUBMIT,","    function (FormEvent $event) {","    $data = $event->getData();","","    // Enregistrer l'adresse e-mail dans la base","    // de données (Imaginons qu'il existe une","    // méthode saveEmail() pour cela)","    saveEmail($data['email']);","","    // Envoyer un message de bienvenue","    sendWelcomeEmail($data['email']);","});"]}]},{"title":"Afficher un message de validation","commands":[{"label":["Afin d'indiquer à l'utilisateur que l'action a bien été effectuée (création, validation, suppression, etc.), vous pouvez afficher un message à l'utilisateur.","- Dans le cas d'une réussite :"],"code":"$this->addFlash('success', 'Votre inscription a été réussie ! Bienvenue !');"},{"label":"- Dans le cas d'une erreur :","code":"$this->addFlash('error', 'Une erreur est survenue lors de l\\'enregistrement de vos données. Veuillez réessayer.');"},{"label":"- Dans le cas d'une alerte :","code":"$this->addFlash('warning', 'Attention : Votre offre va expirer dans 24 heures.');"},{"label":"- Dans le cas d'une information :","code":"$this->addFlash('info', 'N\\'oubliez pas de vérifier vos e-mails pour la confirmation de votre compte.');"},{"label":"Vous pouvez enfin l'afficher dans votre vue Twig, de la manière suivante :","code":["{% for message in app.flashes('success') %}","    <div class=\"alert alert-success\">","        {{ message }}","    </div>","{% endfor %}"]},{"label":"Attention à bien disposer votre message, une <div> sticky ou fixed peut parfois le cacher."}]},{"title":"Valider des données","commands":[{"label":"Les contraintes de validation sont appliquées automatiquement :","code":["{# Affiche les erreurs de validation au-dessus du champ #}","{{ form_errors(myform.name) }}","{{ form_errors(myform.price) }}"]},{"label":"On peut les retirer avec un 'required' => false :","code":["public function configureOptions(OptionsResolver $resolver)","{","    $resolver->setDefaults([","        'data_class' => Post::class,","        'required' => false","    ]);","}"]}]},{"title":"Utiliser les fonctions Twig","commands":[{"label":"Démarrer le balisage du formulaire :","code":"// Démarre le balisage du formulaire {{ form_start(myform) }}"},{"label":"Terminer le balisage du formulaire :","code":"// Termine le balisage du formulaire {{ form_end(myform) }}"},{"label":"Afficher un champ entier (label, widget, erreurs) :","code":["// Affiche un champ entier (label, widget, erreurs)","{{ form_row(myform.field) }}"]},{"label":"Afficher seulement le label du champ :","code":["// Affiche seulement le label du champ","{{ form_label(myform.field) }}"]},{"label":"Afficher seulement le widget du champ :","code":["// Affiche seulement le widget du champ","{{ form_widget(myform.field) }}"]},{"label":"Afficher seulement les erreurs du champ :","code":["// Affiche seulement les erreurs du champ","{{ form_errors(myform.field) }}"]}]}]},{"title":"Utiliser les types de champ","items":[{"title":"Introduction","commands":[]},{"title":"TextType","commands":[{"label":"Il existe de très nombreuses possibilités dans la création des types de champ, des caractéristiques qu'on peut leur appliquer, notamment concernant les contraintes. Voici quelques aperçus."},{"label":"Créer un champ de texte simple avec diverses options :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\TextType;","use Symfony\\Component\\Validator\\Constraints\\Length;","use Symfony\\Component\\Validator\\Constraints\\NotBlank;","// {...}","","// Ajout d'un champ de type texte","->add('name', TextType::class, [","    // Étiquette affichée pour le champ","    'required' => true,","","    // Préciser que si le champ est vide,","    // la valeur vaut '' et non `null`","    'empty_data' => '',","","    // Attributs HTML pour personnaliser","    // l'apparence et le comportement","    'attr' => [","        // Longueur maximale du texte","        'maxlength' => 255,","        // Style CSS inline","        'style' => 'width: 300px;',","        // Désactivation de l'autocomplétion","        'autocomplete' => 'off'","    ],","    // Contraintes de validation pour le champ","    'constraints' => [","        // Le champ ne doit pas être vide","        new NotBlank(),","        // Longueur minimale et maximale","        new Length(['min' => 2, 'max' => 255])","    ]","])"]}]},{"title":"TextareaType","commands":[{"label":"Créer un champ de zone de texte avec options :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\TextareaType;","use Symfony\\Component\\Validator\\Constraints\\Length;","// {...}","","// Ajout d'un champ de type zone de texte","->add('description', TextareaType::class, [","    // Étiquette affichée pour le champ","    'label' => 'Description',","","    // Attributs HTML pour personnaliser","    // l'apparence et le comportement","    'attr' => [","        // Nombre de lignes visibles","        'rows' => 5,","        // Nombre de colonnes visibles","        'cols' => 50,","    ],","    // Contraintes de validation pour le champ","    'constraints' => [","        // Longueur maximale","        new Length([","            'max' => 1000,","            'maxMessage' => \"maximum de caractères requis\"","        ]),","    ]","])"]}]},{"title":"EmailType","commands":[{"label":"Créer un champ de saisie pour email :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\EmailType;","use Symfony\\Component\\Validator\\Constraints\\Email;","use Symfony\\Component\\Validator\\Constraints\\NotBlank;","// {...}","","// Ajout d'un champ de type email","->add('email', EmailType::class, [","    // Contraintes de validation pour le champ","    'constraints' => [","        // Le champ ne doit pas être vide","        new NotBlank([","            'message' => 'Veuillez entrer une adresse e-mail.',","        ]),","        // Valide que le champ est un email","        new Email([","            'message' => 'Veuillez entrer une adresse e-mail valide.',","        ]),","    ]","])"]}]},{"title":"PasswordType","commands":[{"label":"Créer un champ de saisie pour mot de passe. Ici, la regex et le message de validation ont été coupés afin d'améliorer la lisibilité du code.","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\PasswordType;","use Symfony\\Component\\Validator\\Constraints\\Length;","use Symfony\\Component\\Validator\\Constraints\\NotBlank;","use Symfony\\Component\\Validator\\Constraints\\Regex;","// {...}","","->add('password', PasswordType::class, [","// Contraintes de validation pour le champ","'constraints' => [","    // Le champ ne doit pas être vide","    new NotBlank(),","    // Longueur minimale","    new Length([","        'min' => 8,","        'minMessage' => \"maximum de caractères requis\"","    ]),","    new Regex([","        'pattern' => '/(?=.*[a-z])' . PHP_EOL .","            '   (?=.*[A-Z])' . PHP_EOL .","            '   (?=.*[0-9])' . PHP_EOL .","            '   (?=.*[!@#$%^&*()\\-_=+{};:,<.>])/',","        'message' =>","            'Le mot de passe doit contenir :' . PHP_EOL .","            '- Au moins une lettre minuscule' . PHP_EOL .","            '- Au moins une lettre majuscule' . PHP_EOL .","            '- Au moins un chiffre' . PHP_EOL .","            '- Au moins un caractère spécial.',","    ]),","]","])"]},{"label":"Vous pouvez vérifier [italics]séquentiellement[/italics] (pas à pas) la regex en utilisant le mot clef Sequentially ; cela permet à l'utilisateur de n'avoir que le message requis.","code":["use Symfony\\Component\\Validator\\Constraints\\Sequentially;","use Symfony\\Component\\Validator\\Constraints\\Regex;","","// Ajout d'une contrainte Regex avec une approche séquentielle","'constraints' => [","    new Sequentially([","        new Regex([","            'pattern' => '/(?=.*[a-z])/',","            'message' => 'Le mot de passe doit' . PHP_EOL .","            'contenir au moins une lettre minuscule.',","        ]),","        new Regex([","            'pattern' => '/(?=.*[A-Z])/',","            'message' => 'Le mot de passe doit' . PHP_EOL .","            'contenir au moins une lettre majuscule.',","        ]),","        new Regex([","            'pattern' => '/(?=.*[0-9])/',","            'message' => 'Le mot de passe doit' . PHP_EOL .","            'contenir au moins un chiffre.',","        ]),","        new Regex([","            'pattern' => '/(?=.*[!@#$%^&*()\\-_=+{};:,<.>])/',","            'message' => 'Le mot de passe doit' . PHP_EOL .","            'contenir au moins un caractère spécial.',","        ]),","    ]),","],"]}]},{"title":"IntegerType","commands":[{"label":"Créer un champ pour saisie de nombre entier :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\IntegerType;","use Symfony\\Component\\Validator\\Constraints\\NotBlank;","use Symfony\\Component\\Validator\\Constraints\\Positive;","// {...}","","->add('quantity', IntegerType::class, [","    // Attributs HTML pour personnaliser","    // l'apparence et le comportement","    'attr' => [","        // Valeur minimale","        'min' => 1,","        // Valeur maximale","        'max' => 100,","    ],","    // Texte d'aide affiché sous le champ","    'constraints' => [","        // Le champ ne doit pas être vide","        new NotBlank(),","        // La valeur doit être positive","        new Positive()","    ]","])"]}]},{"title":"SearchType","commands":[{"label":"Créer un champ de recherche :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\SearchType;","// {...}","","->add('search', SearchType::class, [])"]}]},{"title":"TelType","commands":[{"label":"Créer un champ de saisie pour numéro de téléphone :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\TelType;","use Symfony\\Component\\Validator\\Constraints\\Regex;","use Symfony\\Component\\Validator\\Constraints\\NotBlank;","","//{...}","","->add('phone', TelType::class, [","    // Contraintes de validation pour le champ","    'constraints' => [","        // Le champ ne doit pas être vide","        new NotBlank(),","        // Doit correspondre à un numéro de téléphone de 10 chiffres","        new Regex(","            '/^[0-9]{10}$/',","            message : \"Ce n'est pas un téléphone valide\"","        )","    ]","])"]}]},{"title":"ChoiceType","commands":[{"label":"Créer un champ de choix (dropdown) :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\ChoiceType;","// {...}","","->add('status', ChoiceType::class, [","    // Liste des choix possibles","    'choices' => [","        // Option 'Canceled' avec valeur 'canceled'","        'Canceled' => 'canceled',","        'Ended' => 'ended',","        'Returning' => 'returning'],","])"]},{"label":"Créer un champ de choix (checkbox ou radio) :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\ChoiceType;","// {...}","","->add('genres', ChoiceType::class, [","    // Liste des choix possibles","    'choices' => [","        // Option 'Western' avec valeur 'western'","        'Western' => 'western',","        'Comedy' => 'comedy',","        'Romance' => 'romance',","        'SF' => 'sf',","        'Fantasy' => 'fantasy',","        'Action' => 'action'],","    // Affiche comme des boutons radio ou des cases à cocher","    'expanded' => true,","    // Permet la sélection multiple si true","    'multiple' => true,","])"]}]},{"title":"EntityType","commands":[{"label":"Créer un champ de sélection pour entité :","code":["use App\\Entity\\Genre;","use Symfony\\Bridge\\Doctrine\\Form\\Type\\EntityType;","// {...}","","->add('genre', EntityType::class, [","    // Classe de l'entité à utiliser","    'class' => Genre::class,","    // Propriété à afficher comme étiquette","    'choice_label' => 'name',","    // Texte par défaut lorsqu'aucun choix n'est sélectionné","    'placeholder' => 'Choose a genre',","])"]}]},{"title":"DateType","commands":[{"label":"Créer un champ de date avec widget :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\DateType;","// {...}","","->add('startDate', DateType::class, [","    // Type de widget (single_text pour un champ de texte unique)","    'widget' => 'single_text',","    // Format d'affichage de la date","    'format' => 'yyyy-MM-dd',","])"]},{"label":"Créer un champ de date (format multiple) :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\DateType;","// {...}","","->add('endDate', DateType::class, [","    // Type de widget (choice pour afficher des","    // menus déroulants pour jour, mois, année)","    'widget' => 'choice',","    // Format d'affichage de la date","    'format' => 'dd-MM-yyyy',","    // Intervalle d'années pour les sélecteurs","    'years' => range(date('Y') - 10, date('Y') + 1),","])"]}]},{"title":"FileType","commands":[{"label":"Créer un champ de fichier avec validation :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\FileType;","use Symfony\\Component\\Validator\\Constraints\\Image;","//{...}","","->add('poster', FileType::class, [","    // Indique si le champ est lié à une propriété de l'entité","    'mapped' => false,","    // Champ requis ou non","    'required' => false,","    // Contraintes de validation pour le champ","    'constraints' => [","        new Image([","            // Taille maximale en kilo-octets","            'maxSize' => '10000k',","            // Types MIME autorisés","            'mimeTypes' => [","                'image/jpeg',","                'image/png'],","            // Message d'erreur pour types MIME invalides","            'mimeTypesMessage' => 'Please upload a valid image file',","            // Message d'erreur pour taille excessive","            'maxSizeMessage' => 'The file is too large, maximum size is 10MB'","        ])","    ],","])"]}]},{"title":"SubmitType","commands":[{"label":"Ajotuer un bouton de soumission du formulaire :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\SubmitType;","//{...}","","->add('save', SubmitType::class, [/*votre_configuration*/])"]}]},{"title":"Label","commands":[{"label":"Ajouter un label (remplacer Votre_type par le type utilisé) :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\Votre_type;","//{...}","","->add('save', Votre_type::class, ['label' => 'Submit',])"]}]},{"title":"Placeholder","commands":[{"label":"Ajouter un placeholder à un champ (remplacer Votre_type par le type utilisé) :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\Votre_type;","//{...}","","->add('email', Votre_type::class, [","    'attr' => [","        'placeholder' => 'Enter your email', // Placeholder pour le champ","    ],","])"]}]},{"title":"Classe","commands":[{"label":"Ajouter une classe pour mettre en forme votre champ (remplacer Votre_type par le type utilisé) :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\Votre_type;","//{...}","","->add('save', Votre_type::class, [","    'attr' => [","        // Classe CSS","        'class' => 'btn btn-primary',","    ],","])"]}]},{"title":"Help","commands":[{"label":"Ajouter une aide à un champ (remplacer Votre_type par le type utilisé) :","code":["use Symfony\\Bridge\\Doctrine\\Form\\Type\\Votre_type;","//{...}","","->add('save', Votre_type::class, [","    'help' => 'Cliquez pour soumettre le formulaire',","])"]}]}]},{"title":"Utilisation de Twig","items":[{"title":"Afficher des variables","commands":[{"label":"Pour afficher le contenu d'une variable, Twig utilise la syntaxe `{{ }}`, autrement appelée les moustaches.","code":"{{ variable }}"}]},{"title":"Utiliser les structures de controle","commands":[{"label":"Pour itérer sur des séquences, Twig propose la boucle for :","code":["{% for utilisateur in utilisateurs %}","  <p>{{ utilisateur.nom }}</p>","{% endfor %}"]},{"label":"Exemple complet pour afficher des box de cases différant par la couleur","code":["#[Route('/box', name: 'box')]","public function testBox(): Response {","    $colors = ['blue', 'red', 'pink', 'purple', 'green', 'orange'];","    return $this->render('test/box.html.twig', [","        'colors' => $colors","    ]);","}"]},{"label":"Exemple complet en Twig pour afficher des box de cases","code":["<div class='container d-flex justify-content-center'\"'>","    <div class=' d-flex gap-3 flex-wrap'>","        {% for color in colors %}","            <div","              class='test-color-box rounded'","              style='background-color: {{ color }}'>","              {{ loop.index }} - {{ color }}","            </div>","        {% endfor %}","    </div>","</div>"]}]},{"title":"Conditionner les vues","commands":[{"label":"Twig permet d'utiliser des conditions avec if :","code":["{% if utilisateur.actif %}","  <p>L'utilisateur est actif.</p>","{% else %}","  <p>L'utilisateur n'est pas actif.</p>","{% endif %}"]}]},{"title":"Utiliser les blocs","commands":[{"label":"Les blocs sont utilisés pour définir des sections de contenu qui peuvent être surchargées dans des templates étendus :","code":["{% block nomDuBloc %}","  Contenu par défaut.","{% endblock %}"]}]},{"title":"Utiliser les fonctions","commands":[{"label":"Twig dispose de fonctions intégrées pour réaliser des tâches courantes :","code":["{{ path('route_name') }}","<!-- Cette fonction génère l'URL d'une route spécifique. -->"]}]},{"title":"Effectuer un test","commands":[{"label":"Twig permet de réaliser des tests dans les conditions :","code":["{% if variable is defined %}","  <p>{{ variable }}</p>","{% endif %}"]}]},{"title":"Inclure des templates","commands":[{"label":"Pour inclure d'autres templates :","code":"{% include 'chemin/vers/template.twig' %}"}]},{"title":"Hériter de templates","commands":[{"label":"Pour hériter d'un template parent :","code":"{% extends 'base.twig' %}"}]}]},{"title":"Filtrage dans Twig","items":[{"title":"capitalize","commands":[{"label":"Convertit une chaîne en minuscules.","code":"{{ hello | capitalize }} <!-- Donne \"Hello\" -->"}]},{"title":"date","commands":[{"label":"Formate une date ou une heure selon un format spécifié.","code":"{{ \"now\" | date(\"Y-m-d\") }} <!-- Donne 2024-06-21 -->"}]},{"title":"default","commands":[{"label":"Fournit une valeur par défaut si la variable est undefined ou null.","code":"{{ variable|default(\"default value\") }}"}]},{"title":"join","commands":[{"label":"Joint les éléments d'un tableau en une seule chaîne avec un séparateur.","code":"{{ [\"one\", \"two\", \"three\"] | join(\", \") }} <!-- Donne \"one, two, three\" -->"}]},{"title":"keys","commands":[{"label":"Renvoie toutes les clés d'un tableau.","code":"{{ {\"name\": \"John\", \"age\": 25}|keys }}"}]},{"title":"length","commands":[{"label":"Donne la longueur d'une chaîne ou le nombre d'éléments dans un tableau.","code":"{{ \"hello\"|length }} <!-- Donne 5 -->"}]},{"title":"lower","commands":[{"label":"Convertit une chaîne en minuscules.","code":"{{ \"HELLO\" | lower }} <!-- Donne \"hello\" -->"}]},{"title":"number_format","commands":[{"label":"Formate un nombre avec des séparateurs de milliers et un nombre spécifique de décimales.","code":"{{ 1000000.15 | number_format(2, '.', ',') }} <!-- Donne 1,000,000.15 -->"}]},{"title":"reverse","commands":[{"label":"Inverse les éléments d'un tableau ou d'une chaîne.","code":"{{ \"abc\"|reverse }} <!-- Donne \"cba\" -->"}]},{"title":"slice","commands":[{"label":"Extrait une sous-chaîne d'une chaîne, similaire à la fonction substr en PHP.","code":"{{ \"Hello\" | slice(1, 3) }} <!-- Donne \"ell\" -->"}]},{"title":"title","commands":[{"label":"Met en majuscule la première lettre de chaque mot.","code":"{{ \"hello world\" | title }} <!-- Donne \"Hello World\" -->"}]},{"title":"trim","commands":[{"label":"Supprime les espaces au début et à la fin d'une chaîne.","code":"{{ \"  hello  \" | trim }} <!-- Donne \"hello\" -->"}]},{"title":"upper","commands":[{"label":"Convertit une chaîne en majuscules.","code":"{{ \"hello\" | upper }} <!-- Donne \"HELLO\" -->"}]}]},{"title":"Doctrine DataFixtures et Faker","items":[{"title":"Installer","commands":[{"label":"Installez le package Doctrine DataFixtures :","code":"composer require orm-fixtures"},{"label":"Installez le package Faker pour générer des données fictives :","code":"composer require fakerphp/faker"}]},{"title":"Créer une classe de fixture","commands":[{"label":"Générez une classe de fixture pour peupler la base de données avec des données fictives :","code":"php bin/console make:fixture AppFixtures"}]},{"title":"Exemple de classe de fixture","commands":[{"label":"Exemple simple de classe de fixture utilisant Faker :","code":["namespace App\\DataFixtures;","","use App\\Entity\\Post;","use Doctrine\\Bundle\\FixturesBundle\\Fixture;","use Doctrine\\Persistence\\ObjectManager;","use Faker\\Factory;","","class AppFixtures extends Fixture {","    public function load(ObjectManager $manager) {","        $faker = Factory::create();","","        for ($i = 0; $i < 10; $i++) {","            $post = new Post();","            $post->setTitle($faker->word);","            $post->setContent($this->faker->paragraph(3))","            $recipe->setSlug($this->faker->slug);","            $recipe->setCreatedAt($this->faker->dateTime);","            $recipe->setUpdatedAt($this->faker->dateTime);","            $manager->persist($post);","        }","","        $manager->flush();","    }","}"]}]},{"title":"Exécuter des fixtures","commands":[{"label":"Pour lancer la création des données, vous pouvez ajouer la fonction créée dans une fonction de controller, et consulter l'URL/route sur un nvaigateur."},{"label":"Ou vous pouvez les fixtures dans la base de données (A confirmer)","code":"php bin/console doctrine:fixtures:load"}]},{"title":"Gerer des références","commands":[{"label":"Utilisez des références pour créer des relations entre les entités dans les fixtures, dans AppFixtures :","code":"$this->addReference('post_1', $post);"},{"label":"ou dans une autre fixture :","code":"$post = $this->getReference('post_1');"}]},{"title":"Configurer des priorités","commands":[{"label":"Définissez l'ordre de chargement des fixtures en utilisant les priorités :","code":["use Doctrine\\Bundle\\FixturesBundle\\Fixture;","use Doctrine\\Common\\DataFixtures\\OrderedFixtureInterface;","","class PostFixtures extends Fixture implements OrderedFixtureInterface {","    public function getOrder() {","        return 1; // Priorité la plus haute","    }","}"]}]},{"title":"Utiliser les propriétés et les méthodes","commands":[{"label":"Générer un nom :","code":"$faker->name;"},{"label":"Générer une adresse :","code":"$faker->address;"},{"label":"Générer un texte :","code":"$faker->text;"},{"label":"Générer un email :","code":"$faker->email;"},{"label":"Générer un nombre aléatoire :","code":"$faker->randomNumber;"},{"label":"Générer une date :","code":"$faker->date;"},{"label":"Générer une URL d'image :","code":"$faker->imageUrl;"},{"label":"Générer un numéro de téléphone :","code":"$faker->phoneNumber;"},{"label":"Générer une entreprise :","code":"$faker->company;"},{"label":"Générer un titre de travail :","code":"$faker->jobTitle;"},{"label":"Générer un mot :","code":"$faker->word;"},{"label":"Générer un paragraphe :","code":"$faker->paragraph;"},{"label":"Générer une couleur hexadécimale :","code":"$faker->hexColor;"},{"label":"Générer une ville :","code":"$faker->city;"},{"label":"Générer un code postal :","code":"$faker->postcode;"},{"label":"Générer une latitude :","code":"$faker->latitude;"},{"label":"Générer une longitude :","code":"$faker->longitude;"},{"label":"Générer une URL :","code":"$faker->url;"},{"label":"Générer un texte avec une longueur spécifique :","code":"$faker->text(200);"},{"label":"Générer un utilisateur :","code":"$faker->userName;"},{"label":"Générer une phrase :","code":"$faker->sentence;"},{"label":"Générer un numéro de carte de crédit :","code":"$faker->creditCardNumber;"},{"label":"Générer une devise :","code":"$faker->currencyCode;"},{"label":"Générer un pays :","code":"$faker->country;"}]},{"title":"Utiliser des groupes de fixtures","commands":[{"label":"Chargez des groupes spécifiques de fixtures :","code":"php bin/console doctrine:fixtures:load --group=GroupName"}]}]},{"title":"Services (En construction !)","items":[{"title":"Introduction aux services","commands":[{"label":["Dans Symfony, il y a un système de [strong]conteneur[/strong] de [strong]services[/strong] qui permet de gérer les dépendances entre les différentes classes de l'application. Le conteneur de services est un endroit central où sont enregistrées les différentes classes (appelées services) et leurs dépendances.","Un [strong]service[/strong] est simplement une classe PHP qui effectue une tâche spécifique. Par exemple, un service pourrait être chargé d'envoyer des emails, de se connecter à une API externe, ou de gérer la logique métier de l'application. Ainsi, on se dote de plusieurs avantages :","- en encapsulant la logique dans des services, on peut peut [strong]réutiliser[/strong] des fonctions dans différentes parties de l'application ;","- les services étant découplés, ils sont plus faciles à [strong]tester[/strong] individuellement ;","- grâce au conteneur de services, on accroît la flexibilité, car il est facile de changer son implémentation au besoin, sans impacter le reste de l'application."]}]},{"title":"Accès aux services","commands":[{"label":"Pour avoir accès à l'ensemble des classes accessibles, notamment si on a besoin d'utiliser l'une d'entre elles, on peut entrer cette ligne de commande :","code":"php bin/console debug:autowiring"},{"label":"Plus spécifiquement, pour chercher des classes qui commencent par un nom particulier vous pouvez ajouter form","code":"php bin/console debug:autowiring App\\Service\\"}]},{"title":"Configuration des services","commands":[{"label":"Les services dans Symfony sont généralement configurés dans des fichiers YAML (services.yaml) situés dans le répertoire config/packages/. Voici un exemple de configuration :","code":["services:","    _defaults:","        autowire: true","        autoconfigure: true","","    App\\:","        resource: '../src/'","        exclude:","            - '../src/DependencyInjection/'","            - '../src/Entity/'","            - '../src/Kernel.php'"]},{"label":["Dans cet exemple :","- La section _defaults active l'autowiring et l'autoconfiguration pour tous les services, ce qui permet de résoudre automatiquement les dépendances et d'appliquer les configurations appropriées.","- La directive App\\: indique que tous les services sous le namespace App doivent être chargés à partir du répertoire spécifié. L'option exclude permet d'ignorer certains répertoires et fichiers lors de la recherche de services."]}]},{"title":"Services et singleton","commands":[{"label":"Les services en Symfony sont souvent configurés comme des singletons. Cela signifie qu'une seule instance d'un service est créée et réutilisée chaque fois qu'elle est demandée. Cela permet d'économiser des ressources et garantit que l'état du service reste cohérent tout au long du cycle de vie de l'application."}]}]},{"title":"Envoi d'un mail","items":[{"title":"Configuration du Mailer","commands":[{"label":"Avant de commencer à envoyer des emails, il est essentiel de configurer le mailer dans votre application Symfony. Cela se fait généralement dans le fichier config/packages/mailer.yaml. Voici un exemple de configuration :","code":["framework:","    mailer:","        dsn: smtp://username:password@smtp.example.com:port"]},{"label":"Le Data Source Name (DSN) contient les informations nécessaires pour se connecter à votre serveur SMTP, y compris l'adresse, le port, le nom d'utilisateur et le mot de passe."}]},{"title":"Création d'un email avec Email","commands":[{"label":"Symfony propose deux classes principales pour créer des emails : Email et TemplatedEmail. Nous utilisation la classe Email, ici !"},{"label":"Instanciation de l'email :","code":["use Symfony\\Component\\Mime\\Email;","","$email = new Email();"]},{"label":"Définir l'expéditeur et le destinataire :","code":["$email->from('expediteur@example.com')","      ->to('destinataire@example.com');"]},{"label":"Ajouter un sujet et du contenu :","code":["$email->subject('Sujet de l\\'email')","      ->text('Contenu texte de l\\'email')","      ->html('<p>Contenu HTML de l\\'email</p>');"]}]},{"title":"Création d'un email avec TemplatedEmail","commands":[{"label":"Pour des emails plus complexes, vous pouvez utiliser TemplatedEmail qui vous permet d'intégrer des templates Twig :","code":["use Symfony\\Bridge\\Twig\\Mime\\TemplatedEmail;","","$email = (new TemplatedEmail())","    ->from('expediteur@example.com')","    ->to('destinataire@example.com')","    ->subject('Sujet de l\\'email')","    ->htmlTemplate('emails/template.html.twig')","    ->context([","        'variable1' => 'valeur1',","        'variable2' => 'valeur2',","    ]);"]}]},{"title":"Envoi de l'Email","commands":[{"label":"Pour envoyer l'email, utilisez le service mailer :","code":"$mailer->send($email);"},{"label":"Cela enverra immédiatement l'email via le transport que vous avez configuré."}]},{"title":"Gestion des Pièces Jointes","commands":[{"label":"Vous pouvez ajouter des fichiers ou des images à vos emails.","code":"$email->attachFromPath('/chemin/vers/fichier.pdf');"},{"label":"Pour afficher des images dans l'email, utilisez la méthode [italics]asInline()[/italics] :","code":["use Symfony\\Component\\Mime\\Part\\DataPart;","use Symfony\\Component\\Mime\\Part\\File;","","$email->addPart((new DataPart(new File('/chemin/vers/image.png'), 'logo', 'image/png'))->asInline());"]}]},{"title":"Utilisation de Twig pour le Contenu","commands":[{"label":"Lorsque vous utilisez Twig pour générer le contenu HTML, vous pouvez facilement intégrer des variables et gérer les images. Définir un espace de noms pour les images dans [italics]config/packages/twig.yaml[/italics] se fait ainsi :","code":["twig:","    paths:","        '%kernel.project_dir%/assets/images': images"]},{"label":"Utiliser le helper Twig pour intégrer les images :","code":"<img src=\"{{ email.image('logo.png') }}\" alt=\"Logo\">"}]},{"title":"Gestion du Contenu Texte","commands":[{"label":"Si vous ne définissez pas explicitement le contenu texte, Symfony génère automatiquement une version texte à partir du HTML. Vous pouvez également définir manuellement le contenu texte en utilisant [italics]text()[/italics] ou [italics]textTemplate()[/italics] :","code":"$email->textTemplate('emails/template.txt.twig');"}]},{"title":"En-têtes (Headers) des Emails","commands":[{"label":"Les en-têtes sont des éléments importants qui fournissent des informations sur l'email. Vous pouvez définir des en-têtes personnalisés comme suit :","code":"$email->getHeaders()->addTextHeader('X-Custom-Header', 'Valeur');"},{"label":"Les en-têtes peuvent inclure des informations comme la priorité, la réponse attendue, etc."}]},{"title":"Gestion des Échecs d'Envoi (Handling Sending Failures)","commands":[{"label":"Il est important de [italics]gérer les échecs[/italics] lors de l'envoi d'emails. Vous pouvez capturer les exceptions lors de l'envoi :","code":["try {","    $mailer->send($email);","} catch (\\Exception $e) {","    // Gérer l'erreur ici (journaliser, alerter, etc.)","}"]}]},{"title":"Debugging (Débogage)","commands":[{"label":"Pour déboguer les problèmes liés à l'envoi d'emails, vous pouvez utiliser la commande suivante pour afficher tous les services disponibles. Cela vous aidera à vérifier que votre service mailer est correctement configuré et accessible.","code":"php bin/console debug:autowiring"}]},{"title":"Contenu HTML et CSS","commands":[{"label":"Lorsque vous créez du contenu HTML pour vos emails, il est conseillé d'utiliser du CSS en ligne pour garantir une meilleure compatibilité avec différents clients email.","code":"<p style=\"color: blue; font-weight: bold;\">Ceci est un message important.</p>"}]},{"title":"Signature et Cryptage des Messages (Signing and Encrypting Messages)","commands":[{"label":"Pour signer ou crypter vos messages, vous pouvez utiliser des bibliothèques comme [strong]OpenSSL[/strong] ou d'autres solutions tierces qui permettent d'ajouter une couche de sécurité aux emails envoyés. Ici, un exemple simple avec OpenSSL :","code":["$encryptedContent = openssl_encrypt($content, 'aes-256-cbc', $key);","$email->html($encryptedContent);"]}]},{"title":"Gestion des Brouillons (Drafts)","commands":[{"label":"Symfony ne gère pas directement les brouillons d'emails comme une fonctionnalité intégrée, mais vous pouvez créer une logique personnalisée pour enregistrer les emails non envoyés dans une base de données ou un système de fichiers avant leur envoi. Voici un exemple simple :","code":["// Enregistrer un brouillon dans la base de données ou un fichier avant envoi.","$draft = new DraftEmail();","$draft->setContent($email->getHtmlBody());","$entityManager->persist($draft);","$entityManager->flush();"]}]},{"title":"Conclusion","commands":[{"label":["L'envoi d'emails avec Symfony est une fonctionnalité puissante qui permet d'intégrer facilement la communication par email dans vos applications web. Grâce à la configuration flexible du mailer, à la gestion avancée du contenu avec Twig et à la possibilité d'ajouter des pièces jointes et des images, vous pouvez créer des emails riches et engageants.","N'oubliez pas de tester vos emails dans différents clients pour garantir une bonne présentation et une bonne fonctionnalité. Utilisez également les fonctionnalités avancées telles que la gestion des échecs d'envoi et la signature/crypte pour sécuriser vos communications."]}]}]},{"title":"La gestion de la sécurité (En construction !)","items":[{"title":"Créer l’entité utilisateur","commands":[{"label":"Vous pouvez utiliser la commande pour générer l'entité utilisateur...","code":"php bin/console make:user"},{"label":"...ou avec Symfony CLI :","code":"symfony console make:user"},{"label":"Pour rajouter des propriétés à l'entité utilisateur, il vous suffit de taper la commande...","code":"php bin/console make:entity User"},{"label":"...ou avec Symfony CLI :","code":"symfony console make:entity User"}]},{"title":"Créer le système d’authentification","commands":[{"label":"Commandes pour générer le système d'authentification","code":"php bin/console make:auth"},{"label":"...ou avec Symfony CLI :","code":"symfony console make:auth"}]},{"title":"Créer le formulaire d’inscription","commands":[{"label":"Commandes pour générer le formulaire d'inscription","code":"symfony console make:registration-form"}]},{"title":"Configurer security.yaml","commands":[{"label":"Configurer le hachage des mots de passe et les providers","code":["// Configuration de base dans security.yaml","security:","  password_hashers:","    Symfony\\Component\\Security\\Core\\User\\PasswordAuthenticatedUserInterface: 'auto'","  providers:","    app_user_provider:","      entity:","        class: App\\Entity\\User","        property: email"]},{"label":"Configurer les firewalls","code":["// Configuration des firewalls dans security.yaml","security:","  firewalls:","    dev:","      pattern: ^/(_(profiler|wdt)|css|images|js)/","      security: false","    main:","      lazy: true","      provider: app_user_provider"]}]},{"title":"Utiliser l'UserInterface","commands":[{"label":"Implémenter UserInterface dans l'entité utilisateur","code":["// L'entité doit implémenter UserInterface.","interface UserInterface {","  public function getUserIdentifier(): string;","  public function getRoles(): array;","  public function getSalt(); // Inutile aujourd'hui","  public function eraseCredentials();","}"]}]},{"title":"Hasher un mot de passe","commands":[{"label":"Implémenter PasswordAuthenticatedUserInterface pour hasher le mot de passe","code":["// L'entité doit implémenter PasswordAuthenticatedUserInterface.","interface PasswordAuthenticatedUserInterface {","  public function getPassword(): string;","}"]}]},{"title":"Configurer le système d’authentification","commands":[{"label":"Configurer l'authentification dans security.yaml","code":["// Configuration pour l'authentification.","security:","  firewalls:","    main:","      custom_authenticator: App\\Security\\AppAuthenticator","      logout:","        path: app_logout"]}]},{"title":"Contrôleur généré","commands":[{"label":"Contrôleur pour la connexion et la déconnexion","code":["// Route pour afficher le formulaire de connexion.","#[Route('/login', name: 'app_login')]","public function login(): Response {","  // Symfony intercepte la requête pour traiter le formulaire.","}","// Route pour la déconnexion.","#[Route('/logout', name: 'app_logout')]","public function logout(): void {","  // Symfony intercepte la requête pour déconnecter l'utilisateur.","}"]}]},{"title":"Fichier Twig généré","commands":[{"label":"Formulaire de connexion en Twig","code":["// Formulaire de connexion généré.","{% block body %}","  <form method=\"post\">","    <input type=\"text\" name=\"_username\" required>","    <input type=\"password\" name=\"_password\" required>","    <button type=\"submit\">Se connecter</button>","  </form>","{% endblock %}"]}]},{"title":"Authenticator","commands":[{"label":"Configurer l'Authenticator pour la connexion","code":["// Authenticator dans src/Security/AppAuthenticator.","public function onAuthenticationSuccess(Request $request, TokenInterface $token,","  string $firewallName): ?Response {","  if ($targetPath = $this->getTargetPath($request->getSession(), $firewallName)) {","    return new RedirectResponse($targetPath);","  }","  // Redirigez vers une route appropriée.","  throw new \\Exception('TODO: provide a valid redirect inside '.__FILE__);","}"]}]},{"title":"Créer le formulaire d’inscription","commands":[{"label":"Commandes pour générer le formulaire d'inscription (le contrôleur, le fichier Twig, et le formulaire Symfony pour l'inscription)","code":"symfony console make:registration-form"}]},{"title":"Configurer le contrôleur d'inscription","commands":[{"label":"Configurer le contrôleur pour gérer l'inscription","code":["// Contrôleur pour afficher et traiter l'inscription.","public function register(","    Request $request,","    UserPasswordHasherInterface $passwordHasher): Response {","  $user = new User();","  $form = $this->createForm(RegistrationFormType::class, $user);","  $form->handleRequest($request);","  if ($form->isSubmitted() && $form->isValid()) {","    // Hachage du mot de passe","    $user->setPassword(","      $passwordHasher->hashPassword(","        $user,","        $form->get('plainPassword')->getData()","      )","    );","    // Enregistrement de l'utilisateur","    $entityManager = $this->getDoctrine()->getManager();","    $entityManager->persist($user);","    $entityManager->flush();","    return $this->redirectToRoute('home');","  }","  return $this->render('registration/register.html.twig', [","    'registrationForm' => $form->createView(),","  ]);","}"]}]},{"title":"Accéder à l’utilisateur connecté","commands":[{"label":"Accéder à l'utilisateur dans un contrôleur","code":["// Récupère l'utilisateur connecté.","$user = $this->getUser();"]},{"label":"Accéder à l'utilisateur dans Twig","code":["// Affiche l'utilisateur connecté dans un template Twig.","{{ app.user }}"]}]},{"title":"Les rôles","commands":[{"label":"Les rôles sont des chaînes de caractères commençant par ROLE_. Ils peuvent être définis dans l'entité utilisateur."}]},{"title":"Restreindre l’accès à une page","commands":[{"label":"Restreindre l'accès à une page dans un contrôleur","code":["// Utilisez denyAccessUnlessGranted pour restreindre l'accès.","public function adminDashboard(): Response {","  $this->denyAccessUnlessGranted('ROLE_ADMIN');","  return $this->render('admin/dashboard.html.twig');","}"]},{"label":"Restreindre l'accès à une page avec des attributs","code":["// Utilisez IsGranted pour restreindre l'accès avec des attributs.","#[IsGranted('ROLE_ADMIN')]","public function adminDashboard(): Response {","  return $this->render('admin/dashboard.html.twig');","}"]},{"label":"Restreindre l'accès dans security.yaml","code":["security:","  access_control:","    - { path: ^/admin, roles: ROLE_ADMIN }"]}]},{"title":"Vérifier un rôle dans Twig","commands":[{"label":"Vérifier un rôle dans un template Twig","code":["// Vérifiez si l'utilisateur est connecté.","{% if app.user %}","  <a href=\"{{ path('app_logout') }}\">Déconnexion</a>","{% endif %}","// Vérifiez si l'utilisateur a un rôle spécifique.","{% if is_granted('ROLE_ADMIN') %}","  <a href=\"{{ path('admin_dashboard') }}\">Back-office</a>","{% endif %}"]}]},{"title":"Configurer la hiérarchie des rôles","commands":[{"label":"Vous pouvez définir la hiérarchie des rôles dans security.yaml. Un rôle peut hériter de toutes les permissions d’un autre.","code":["security:","  role_hierarchy:","    ROLE_ADMIN: ROLE_USER","    ROLE_SUPER_ADMIN: ROLE_ADMIN"]}]},{"title":"Configurer le \"Remember Me\"","commands":[{"label":"Configurer la fonctionnalité 'Se souvenir de moi' dans security.yaml","code":["security:","  firewalls:","    main:","      remember_me:","        secret: '%kernel.secret%'","        lifetime: 604800 // 1 semaine en secondes","        path: /"]},{"label":"Ajouter RememberMeBadge dans l'Authenticator","code":["// Ajoutez RememberMeBadge dans authenticate().","public function authenticate(Request $request): PassportInterface {","  return new Passport(","    new UserBadge($email),","    new PasswordCredentials($request->request->get('password', '')),","    [","      new CsrfTokenBadge('authenticate', $request->get('_csrf_token')),","      new RememberMeBadge()","    ]","  );","}"]}]},{"title":"Récupérer un mot de passe","commands":[{"label":"Installer le module pour récupération de mot de passe","code":"symfony composer require symfonycasts/reset-password-bundle"},{"label":"Générer le système de récupération de mot de passe","code":"symfony console make:reset-password"}]}]}]}